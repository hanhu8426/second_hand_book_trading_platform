"use strict";(self["webpackChunkbook_02"]=self["webpackChunkbook_02"]||[]).push([[683],{2900:function(e,o,a){a.d(o,{Mv:function(){return u},RO:function(){return c},Sr:function(){return m},sz:function(){return d},yq:function(){return s},z$:function(){return i}});var t=a(4161),r=a(6779);const l="http://localhost:8080";function n(e,o={},a="GET"){return new Promise((function(r,l){let n;if("GET"===a){let a="";Object.keys(o).forEach((e=>{a+=e+"="+o[e]+"&"})),""!==a&&(a=a.substring(0,a.lastIndexOf("&")),e=e+"?"+a),n=t.Z.get(e)}else n=t.Z.post(e,o);n.then((function(e){r(e)})).catch((function(e){l(e)}))}))}const s=({account:e,password:o})=>n("http://localhost:8080/Login",{account:e,password:o},"POST"),u=(e,o)=>(0,r.Z)(l+"/Register",{account:e,password:o}),i=()=>(0,r.Z)(l+"/getUserInfo",{}),c=(e,o)=>(0,r.Z)(l+"/user/PwdManage",{oldPassword:e,newPassword:o},"POST"),d=e=>(0,r.Z)(l+"/user/userInfoOne",{charge:e},"POST"),m=(e,o,a,t,n)=>(0,r.Z)(l+"/user/userInfo",{file:e,phone:o,area:a,gender:t,introduction:n},"POST")},1683:function(e,o,a){a.r(o),a.d(o,{default:function(){return U}});var t=a(3396);const r=e=>((0,t.dD)("data-v-97943170"),e=e(),(0,t.Cn)(),e),l={class:"content"},n={class:"box_info"},s={class:"tab_box"},u={class:"modify_box"},i={class:"tab_box"},c={class:"modify_box"},d=r((()=>(0,t._)("span",null,"上传头像",-1)));function m(e,o,a,r,m,h){const p=(0,t.up)("el-input"),g=(0,t.up)("el-button"),f=(0,t.up)("el-tab-pane"),b=(0,t.up)("UploadPage"),w=(0,t.up)("el-form-item"),v=(0,t.up)("el-option"),_=(0,t.up)("el-select"),I=(0,t.up)("el-dropdown"),F=(0,t.up)("el-form"),y=(0,t.up)("el-tabs");return(0,t.wg)(),(0,t.iD)("div",l,[(0,t._)("div",n,[(0,t.Wm)(y,{modelValue:m.activeName,"onUpdate:modelValue":o[6]||(o[6]=e=>m.activeName=e),onTabClick:h.handleClick,"stretch:true":"",class:"tabContainer",ref:"chargeName"},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{label:"账号充值",name:"first"},{default:(0,t.w5)((()=>[(0,t._)("div",s,[(0,t._)("div",u,[(0,t.Wm)(p,{type:"text",modelValue:m.chargeNum.charge,"onUpdate:modelValue":o[0]||(o[0]=e=>m.chargeNum.charge=e),autocomplete:"off",placeholder:"请输入金额"},null,8,["modelValue"]),(0,t.Wm)(g,{type:"primary",style:{width:"120px"},"native-type":"submit",onClick:o[1]||(o[1]=e=>h.submitForm_1("chargeName"))},{default:(0,t.w5)((()=>[(0,t.Uk)("确认充值")])),_:1})])])])),_:1}),(0,t.Wm)(f,{label:"个人信息",name:"second",style:{height:"500px"}},{default:(0,t.w5)((()=>[(0,t._)("div",i,[(0,t._)("div",c,[(0,t.Wm)(F,{model:m.InfoForm,"status-icon":"",rules:m.ruleInfo,ref:"InfoForm","label-width":"80px"},{default:(0,t.w5)((()=>[(0,t.Wm)(b,{ref:"uploadImg",onDataUpdated:h.handleDataFromChild},{default:(0,t.w5)((()=>[d])),_:1},8,["onDataUpdated"]),(0,t.Wm)(w,{prop:"phone",label:"电话号码"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{placeholder:"输入你的手机号码",type:"text",autocomplete:"off",modelValue:this.InfoForm.phone,"onUpdate:modelValue":o[2]||(o[2]=e=>this.InfoForm.phone=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(w,{prop:"gender",label:"性别"},{default:(0,t.w5)((()=>[(0,t.Wm)(I,{style:{width:"100%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{modelValue:m.InfoForm.gender,"onUpdate:modelValue":o[3]||(o[3]=e=>m.InfoForm.gender=e),placeholder:"请选择性别"},{default:(0,t.w5)((()=>[(0,t.Wm)(v,{label:"男",value:"男"}),(0,t.Wm)(v,{label:"女",value:"女"})])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(w,{prop:"area",label:"校区"},{default:(0,t.w5)((()=>[(0,t.Wm)(I,{style:{width:"100%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{modelValue:m.InfoForm.area,"onUpdate:modelValue":o[4]||(o[4]=e=>m.InfoForm.area=e),placeholder:"请选择校区"},{default:(0,t.w5)((()=>[(0,t.Wm)(v,{label:"四牌楼校区",value:"四牌楼校区"}),(0,t.Wm)(v,{label:"九龙湖校区",value:"九龙湖校区"}),(0,t.Wm)(v,{label:"丁家桥校区",value:"丁家桥校区"})])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(w,{prop:"introduction",label:"简介"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{type:"textarea",placeholder:"说两句介绍自己吧",autocomplete:"off",modelValue:this.InfoForm.introduction,"onUpdate:modelValue":o[5]||(o[5]=e=>this.InfoForm.introduction=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(w,null,{default:(0,t.w5)((()=>[(0,t.Wm)(g,{type:"primary",style:{width:"120px"},"native-type":"submit",onClick:h.submitForm_2},{default:(0,t.w5)((()=>[(0,t.Uk)("确认修改")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])])])])),_:1})])),_:1},8,["modelValue","onTabClick"])])])}a(7658);var h=a(2900);const p=e=>((0,t.dD)("data-v-0caab470"),e=e(),(0,t.Cn)(),e),g=["src"],f={key:1,class:"el-icon-plus avatar-uploader-icon"},b=p((()=>(0,t._)("span",null,"头像上传",-1)));function w(e,o,a,r,l,n){const s=(0,t.up)("el-upload");return(0,t.wg)(),(0,t.iD)("div",null,[(0,t.Wm)(s,{class:"avatar-uploader",action:"http://localhost:8080/upload","show-file-list":!0,"on-remove":n.handleAvatarFail,"on-success":n.handleSuccess,"before-upload":n.beforeAvatarUpload,headers:n.headersJWT},{default:(0,t.w5)((()=>[l.imageUrl?((0,t.wg)(),(0,t.iD)("img",{key:0,src:l.imageUrl,class:"avatar",alt:"图片详情"},null,8,g)):((0,t.wg)(),(0,t.iD)("i",f)),b])),_:1},8,["on-remove","on-success","before-upload","headers"])])}var v={name:"UploadPage",data(){return{imageUrl:""}},methods:{handleSuccess(e){console.log("图片上传成功，但是还没收到返回的数据"),1==e.data.code?(console.log("收到了response"),this.imageUrl=e.data.data):console.log("收不到response"),console.log("打印后端返回的图片路径"),console.log(this.imageUrl)},beforeAvatarUpload(e){const o="image/jpeg"===e.type,a=e.size/1024/1024<2;return o||this.$message.error("上传头像图片只能是 JPG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),o&&a},handleAvatarFail(){console.log("文件已被移动")}},computed:{headersJWT(){const e=localStorage.getItem("token");return{Authorization:e}}}},_=a(89);const I=(0,_.Z)(v,[["render",w],["__scopeId","data-v-0caab470"]]);var F=I,y={name:"UserInfo",components:{UploadPage:F},data(){var e=(e,o,a)=>{if(!o)return a(new Error("充值数额不能为空"))},o=(e,o,a)=>{if(!o)return a(new Error("手机号不能为空"));setTimeout((()=>{o.length>11?a(new Error("手机号不能大于11位")):a()}),1e3)},a=(e,o,a)=>{if(!o)return a(new Error("自我介绍不能为空"));setTimeout((()=>{o.length<5?a(new Error("自我介绍不能少于5个字")):a()}),1e3)};return{chargeNum:{charge:" "},rules:{charge:[{validator:e,trigger:"blur"}]},InfoForm:{img:"",phone:"",area:"",gender:"",introduction:""},ruleInfo:{img:"",phone:[{validator:o,trigger:"blur"}],area:"",gender:"",introduction:[{validator:a,trigger:"blur"}]},activeName:"first"}},methods:{changeInput(){this.$forceUpdate()},handleClick(e,o){console.log(e,o)},submitForm_1(){console.log(this.chargeNum.charge),(0,h.sz)({charge:this.chargeNum.charge}).then((e=>{1==e.data.code?(console.log("=====上传成功======="),console.log("打印余额"),console.log(e.data.data),"success"==e.msg?this.$message({type:"success",message:"上传成功！",duration:1e3}):(this.$message({type:"success",message:"上传成功！",duration:1e3}),setTimeout((()=>{this.$router.push({path:"/user/userCenter"})}),1e3))):this.$message({type:"waring",message:"充值失败"})})).catch((()=>{this.$message.error("充值失败")}))},handleDataFromChild(e){this.InfoForm.img=e.imageUrl},submitForm_2(){console.log("这是用来测试的输出"),console.log(this.InfoForm.img),console.log(this.InfoForm.phone),console.log(this.InfoForm.area),console.log(this.InfoForm.gender),console.log(this.InfoForm.introduction),console.log("=====上传表格2======="),(0,h.Sr)({img:this.InfoForm.img,phone:this.InfoForm.phone,area:this.InfoForm.area,gender:this.InfoForm.gender,introduction:this.InfoForm.introduction}).then((e=>{1==e.data.code?(console.log("=====上传成功======="),"success"==e.msg?this.$message({type:"success",message:"上传成功！",duration:1e3}):(this.$message({type:"success",message:"上传成功！",duration:1e3}),setTimeout((()=>{this.$router.push({path:"/user/userCenter"})}),1e3))):this.$message({type:"waring",message:"资料上传失败1"})})).catch((()=>{this.$message.error("资料上传失败2")}))},sendBalanceMessage(){},resetForm(e){this.$refs[e].resetFields()}}};const W=(0,_.Z)(y,[["render",m],["__scopeId","data-v-97943170"]]);var U=W}}]);
//# sourceMappingURL=683.1b0e756c.js.map