"use strict";(self["webpackChunkbook_02"]=self["webpackChunkbook_02"]||[]).push([[359],{5359:function(e,o,a){a.r(o),a.d(o,{default:function(){return z}});var l=a(3396),t=a(7139);const s=e=>((0,l.dD)("data-v-73654b97"),e=e(),(0,l.Cn)(),e),i={class:"content"},d=s((()=>(0,l._)("h1",null,"我的书摊",-1))),n={class:"box_info"},r={class:"book_list"},c=s((()=>(0,l._)("i",{class:"el-icon-edit"},null,-1))),m=s((()=>(0,l._)("p",{style:{"font-size":"14px"}},"添加新的书籍",-1))),u=[c,m],p={class:"bookCover"},h={class:"bookName"},g={style:{float:"right","font-size":"14px",color:"#757575"}},b={class:"author"},k={class:"Description"},f={class:"foot"},y=["onClick"],w={class:"dialog-footer"};function _(e,o,a,s,c,m){const _=(0,l.up)("el-image"),v=(0,l.up)("upload-book"),W=(0,l.up)("el-input"),V=(0,l.up)("el-form-item"),T=(0,l.up)("el-option"),U=(0,l.up)("el-select"),B=(0,l.up)("el-dropdown"),x=(0,l.up)("el-form"),I=(0,l.up)("el-button"),L=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.iD)("div",i,[d,(0,l._)("div",n,[(0,l._)("div",r,[(0,l._)("div",{class:"add",onClick:o[0]||(o[0]=(...e)=>m.handleAdd&&m.handleAdd(...e))},u)]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(c.bookList,(e=>((0,l.wg)(),(0,l.iD)("div",{class:"book_list",key:e.bookId},[(0,l._)("div",p,[(0,l.Wm)(_,{src:"book.image"},{default:(0,l.w5)((()=>[(0,l.Uk)(' alt="书籍封面">')])),_:1})]),(0,l._)("div",h,[(0,l.Uk)((0,t.zw)(e.name)+" ",1),(0,l._)("span",g,(0,t.zw)(this.TextForType[2]),1)]),(0,l._)("div",b,(0,t.zw)(e.author),1),(0,l._)("div",k,(0,t.zw)(e.description),1),(0,l._)("div",f,[(0,l._)("span",{style:{float:"right"},onClick:o=>m.delBook(e)},"删除",8,y),(0,l._)("span",{style:{float:"right","margin-right":"10px"},onClick:o[1]||(o[1]=(...e)=>m.handleMod&&m.handleMod(...e))},"修改")])])))),128))]),(0,l.Wm)(L,{title:"添加新的书籍",modelValue:c.dialogVisible,"onUpdate:modelValue":o[11]||(o[11]=e=>c.dialogVisible=e),width:"50%",center:""},{footer:(0,l.w5)((()=>[(0,l._)("span",w,[(0,l.Wm)(I,{onClick:o[9]||(o[9]=e=>c.dialogVisible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取 消")])),_:1}),(0,l.Wm)(I,{type:"primary",onClick:o[10]||(o[10]=e=>m.onSubmit("form"))},{default:(0,l.w5)((()=>[(0,l.Uk)("确 定")])),_:1})])])),default:(0,l.w5)((()=>[(0,l.Wm)(x,{ref:"form",model:c.book},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{ref:"bookPaper"},null,512),(0,l.Wm)(V,null,{default:(0,l.w5)((()=>[(0,l.Wm)(W,{placeholder:"书名",modelValue:c.book.name,"onUpdate:modelValue":o[2]||(o[2]=e=>c.book.name=e)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(V,null,{default:(0,l.w5)((()=>[(0,l.Wm)(W,{placeholder:"作者",modelValue:c.book.author,"onUpdate:modelValue":o[3]||(o[3]=e=>c.book.author=e)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(V,null,{default:(0,l.w5)((()=>[(0,l.Wm)(W,{placeholder:"ISBN",modelValue:c.book.isbn,"onUpdate:modelValue":o[4]||(o[4]=e=>c.book.isbn=e)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(V,null,{default:(0,l.w5)((()=>[(0,l.Wm)(B,{style:{width:"100%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(U,{modelValue:c.book.type,"onUpdate:modelValue":o[5]||(o[5]=e=>c.book.type=e),placeholder:"请选择类型",onChange:m.changeLable},{default:(0,l.w5)((()=>[(0,l.Wm)(T,{label:"历史和政治类",value:"1"}),(0,l.Wm)(T,{label:"文学和艺术类",value:"2"}),(0,l.Wm)(T,{label:"科学和技术类",value:"3"}),(0,l.Wm)(T,{label:"商业和经济类",value:"4"}),(0,l.Wm)(T,{label:"心理学和自助类",value:"5"}),(0,l.Wm)(T,{label:"旅游和地理类",value:"6"}),(0,l.Wm)(T,{label:"工具书类",value:"7"})])),_:1},8,["modelValue","onChange"])])),_:1})])),_:1}),(0,l.Wm)(V,null,{default:(0,l.w5)((()=>[(0,l.Wm)(W,{type:"textarea",placeholder:"简介",modelValue:c.book.description,"onUpdate:modelValue":o[6]||(o[6]=e=>c.book.description=e)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(V,{prop:"area"},{default:(0,l.w5)((()=>[(0,l.Wm)(B,{style:{width:"100%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(U,{modelValue:c.book.campus,"onUpdate:modelValue":o[7]||(o[7]=e=>c.book.campus=e),placeholder:"请选择校区"},{default:(0,l.w5)((()=>[(0,l.Wm)(T,{label:"四牌楼校区",value:"1"}),(0,l.Wm)(T,{label:"九龙湖校区",value:"2"}),(0,l.Wm)(T,{label:"丁家桥校区",value:"3"})])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(V,null,{default:(0,l.w5)((()=>[(0,l.Wm)(W,{placeholder:"价格",modelValue:c.book.price,"onUpdate:modelValue":o[8]||(o[8]=e=>c.book.price=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])}var v=a(6779);const W="http://localhost:8080",V=e=>(0,v.Z)(W+"/addBook",{name:e.name,author:e.author,isbn:e.isbn,type:e.type,description:e.description,status:e.status,campus:e.campus,price:e.price,recommend:e.recommend},"POST"),T=e=>(0,v.Z)(W+"/modifyBook",{bookId:e.bookId,image:e.image,name:e.name,author:e.author,type:e.type,description:e.description,price:e.price},"POST"),U=e=>(0,v.Z)(W+"/delBook",{bookId:e}),B=()=>(0,v.Z)(W+"/getBookList",{}),x=(0,l._)("span",null,"上传书籍",-1),I=["src"],L={key:1,class:"el-icon-plus avatar-uploader-icon"};function $(e,o,a,t,s,i){const d=(0,l.up)("el-upload");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)(d,{class:"avatar-uploader",action:"http://localhost:8080/Upload","show-file-list":!1,"on-success":i.handleAvatarSuccess,"before-upload":i.beforeAvatarUpload,headers:i.headersJWT},{default:(0,l.w5)((()=>[x,s.imageUrl?((0,l.wg)(),(0,l.iD)("img",{key:0,src:s.imageUrl,class:"avatar",alt:"书籍封面"},null,8,I)):((0,l.wg)(),(0,l.iD)("i",L))])),_:1},8,["on-success","before-upload","headers"])])}var C={name:"UploadBook",data(){return{imageUrl:"",image:""}},methods:{handleAvatarSuccess(e,o){this.imageUrl=URL.createObjectURL(o.raw),console.log(this.imageUrl),console.log(e),this.image=e.data,console.log(e.data)},beforeAvatarUpload(e){const o="image/jpeg"===e.type,a=e.size/1024/1024<2;return o||this.$message.error("上传书籍图片只能是 JPG 格式!"),a||this.$message.error("上传书籍图片大小不能超过 2MB!"),o&&a}},computed:{headersJWT(){const e=localStorage.getItem("token");return{Authorization:e}}}},A=a(89);const D=(0,A.Z)(C,[["render",$]]);var F=D,P={name:"BookStallPage",components:{UploadBook:F},data(){return{dialogVisible:!1,isEdit:!1,TextForType:["历史和政治类","文学和艺术类","科学和技术类","商业和经济类","心理学和自助类","旅游和地理类","工具书类"],bookList:[{BookId:1,name:"黄哥的恋爱节奏",author:"黄文敬",isbn:"",type:1,description:"讲述了黄哥的恋爱心路历程，惊心动魄，感人肺腑",status:"",image:"",campus:"",price:"25",newProduct:"",recommend:"",sellerID:""},{bookId:2,name:"算出来的秘密爱情",author:"胡丹婷",isbn:"",type:2,description:"",status:"",image:"",campus:"",price:"",newProduct:"",recommend:"",sellerID:""}],book:{bookId:"",name:"",author:"",isbn:"",type:"",description:"",status:"",image:"",campus:"",price:"",recommend:"",sellerID:""}}},created(){console.log("开始生命构建"),this.getBookList()},mounted(){console.log("开始生命构建"),this.getBookList()},methods:{changeLable(){switch(this.book.type){case"1":this.TextForType="历史和政治类";break;case"2":this.TextForType="文学和艺术类";break;case"3":this.TextForType="科学和技术类";break;case"4":this.TextForType="商业和经济类";break;case"5":this.TextForType="心理学和自助类";break;case"6":this.TextForType="旅游和地理类";break;case"7":this.TextForType="工具书类";break;default:console.log("default")}},handleAdd(){this.dialogVisible=!0,this.isEdit=!1},handleMod(e){this.dialogVisible=!0,this.isEdit=!0,this.book.bookId=e.bookId,this.book.image=this.$refs.bookPaper.image,this.book.name=e.name,this.book.author=e.author,this.book.type=e.type,this.book.description=e.description,this.book.price=e.price},onSubmit(){this.isEdit?this.modifyBook():this.addBook()},getBookList(){console.log("===获取的书籍列表：==="+this.$store.getters.getUser.account+"====="),B().then((e=>{if(console.log(e),1==e.data.code){let o=e.data.data;console.log(o),this.bookList=o}else this.$message({message:e.message,type:"warning"})})).catch((e=>{console.log(e)}))},addBook(){console.log(this.book),console.log(this.TextForType),console.log("在向后端传送书籍的资料前进行赋值"),this.book.status=1,this.book.recommend="boolean",this.book.image=this.$refs.bookPaper.image,console.log(this.book),V(this.book).then((e=>{console.log(e),1==e.data.code?(this.$message({message:e.message,type:"success"}),this.dialogVisible=!1,this.getAddressList()):this.$message({message:e.message,type:"warning"})})).catch((e=>{console.log(e)}))},modifyBook(){T(this.book).then((e=>{console.log(e),1==e.data.code?(this.$message({message:e.message,type:"success"}),this.dialogVisible=!1,this.getAddressList()):this.$message({message:e.message,type:"warning"})})).catch((e=>{console.log(e)}))},delBook(e){console.log("删除测试"),console.log(e.bookId),this.$confirm("是否要进行删除操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{U(e.bookId).then((e=>{console.log(e),1==e.data.code?(this.$message({message:e.message,type:"success"}),this.getAddressList()):this.$message({message:e.message,type:"warning"})})).catch((e=>{console.log(e)}))})).catch((()=>{console.log("取消删除了")}))}}};const S=(0,A.Z)(P,[["render",_],["__scopeId","data-v-73654b97"]]);var z=S}}]);
//# sourceMappingURL=359.233ccd65.js.map