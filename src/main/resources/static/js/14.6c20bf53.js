"use strict";(self["webpackChunkbook_02"]=self["webpackChunkbook_02"]||[]).push([[14],{9896:function(e,o,t){t.d(o,{G3:function(){return a},Ms:function(){return n},eZ:function(){return i},fA:function(){return l}});var s=t(6779);const r="http://localhost:8080",n=e=>(0,s.Z)(`${r}/getBook/${e}`),a=e=>(0,s.Z)(r+"/getRecBookList",{sort:e}),i=(e,o,t)=>(0,s.Z)(r+"/getBookListBySort",{type:e,page:o,pageSize:t}),l=(e,o,t,n)=>(0,s.Z)(r+"/getBookListByName",{name:e,author:o,page:t,pageSize:n})},2900:function(e,o,t){t.d(o,{Mv:function(){return l},RO:function(){return d},Sg:function(){return p},Sr:function(){return g},nh:function(){return m},sz:function(){return u},tT:function(){return h},yq:function(){return i},z$:function(){return c}});var s=t(4161),r=t(6779);const n="http://localhost:8080";function a(e,o={},t="GET"){return new Promise((function(r,n){let a;if("GET"===t){let t="";Object.keys(o).forEach((e=>{t+=e+"="+o[e]+"&"})),""!==t&&(t=t.substring(0,t.lastIndexOf("&")),e=e+"?"+t),a=s.Z.get(e)}else a=s.Z.post(e,o);a.then((function(e){r(e)})).catch((function(e){n(e)}))}))}const i=({account:e,password:o})=>a("http://localhost:8080/Login",{account:e,password:o},"POST"),l=(e,o)=>(0,r.Z)(n+"/Register",{account:e,password:o}),c=()=>(0,r.Z)(n+"/getUserInfo",{}),d=(e,o)=>(0,r.Z)(n+"/user/PwdManage",{oldPassword:e,newPassword:o},"POST"),u=e=>(0,r.Z)(n+"/user/userInfoOne",{charge:e},"POST"),g=(e,o,t,s,a)=>(0,r.Z)(n+"/user/userInfo",{img:e,phone:o,area:t,gender:s,introduction:a},"POST"),h=()=>(0,r.Z)(n+"/listUserOrders",{},"POST"),p=e=>(0,r.Z)(n+"/end",{orderId:e},"POST"),m=e=>(0,r.Z)(n+"/GetOrderByOrderId",{orderId:e},"POST")},6014:function(e,o,t){t.r(o),t.d(o,{default:function(){return P}});var s=t(3396),r=t(7139),n=t(9242);const a=e=>((0,s.dD)("data-v-8a65cccc"),e=e(),(0,s.Cn)(),e),i={class:"content"},l=a((()=>(0,s._)("h1",null,"我的订单",-1))),c={class:"box_info"},d={class:"tab_box"},u={class:"order_summary"},g={key:0,class:"order_status"},h={key:1,class:"order_status"},p={class:"caption-info"},m=a((()=>(0,s._)("span",null,"|",-1))),f=a((()=>(0,s._)("span",null,"|",-1))),k={style:{float:"right"}},b={class:"bookInfo"},_={class:"book_item"},w={class:"book_action"},y=["onClick"],v=a((()=>(0,s._)("br",null,null,-1))),I=["onClick"],T=a((()=>(0,s._)("br",null,null,-1))),C={style:{margin:"10px 0px 20px",width:"100%"}},S={class:"block",style:{float:"right"}};function O(e,o,t,a,O,z){const D=(0,s.up)("el-image"),B=(0,s.up)("el-tab-pane"),Z=(0,s.up)("el-tabs"),L=(0,s.up)("el-pagination");return(0,s.wg)(),(0,s.iD)("div",i,[l,(0,s._)("div",c,[(0,s.Wm)(Z,{modelValue:O.activeName,"onUpdate:modelValue":o[0]||(o[0]=e=>O.activeName=e),onTabClick:z.handleClick},{default:(0,s.w5)((()=>[(0,s.Wm)(B,{label:"全部有效订单",name:"first"},{default:(0,s.w5)((()=>[(0,s._)("div",d,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(O.orderAndBookList,((e,o)=>((0,s.wg)(),(0,s.iD)("div",{class:"order_list",key:o},[(0,s._)("div",u,[(0,s._)("div",null,[1===e.order.status?((0,s.wg)(),(0,s.iD)("p",g,"订单待收货")):(0,s.kq)("",!0),2===e.order.status?((0,s.wg)(),(0,s.iD)("p",h,"订单已完成")):(0,s.kq)("",!0)]),(0,s._)("p",p,[(0,s.Uk)((0,r.zw)(e.order.beginTime)+" ",1),m,(0,s.Uk)(" "+(0,r.zw)(e.order.name)+" ",1),f,(0,s.Uk)(" 订单号："+(0,r.zw)(e.order.orderId)+" ",1),(0,s._)("span",k,"实付金额："+(0,r.zw)(e.book.price),1)])]),(0,s._)("div",b,[(0,s._)("div",_,[(0,s.Wm)(D,{class:"bookImg",src:e.book.image,fit:"fill"},null,8,["src"])]),(0,s._)("div",w,[(0,s.wy)((0,s._)("button",{class:"plainBtn",onClick:o=>z.handleChange(e)},"确认收货",8,y),[[n.F8,1===e.order.status]]),v,(0,s._)("button",{class:"plainBtn",onClick:o=>z.goToOrderDetail(e)},"订单详情",8,I),T])])])))),128))])])),_:1})])),_:1},8,["modelValue","onTabClick"])]),(0,s.wy)((0,s._)("div",C,[(0,s._)("div",S,[(0,s.Wm)(L,{onSizeChange:e.handleSizeChange,onCurrentChange:e.handleCurrentChange,"current-page":O.currentPage,"page-sizes":[5,10,20,50],"page-size":O.page_size,background:"",layout:"total, sizes, prev, pager, next, jumper",total:O.total},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])])],512),[[n.F8,O.total>0]])])}t(7658);var z=t(2900),D=t(9896),B={name:"UserOrder",data(){return{showDetail:!1,activeName:"first",currentPage:1,page_size:5,total:20,orderAndBookList:[{order:{orderId:54564651321,buyerId:5,sellerId:2,name:"黄文敬",phone:"1235444755",address:"梅园一栋测试测试测试",bookId:"2",beginTime:"2020.2.21",endTime:"2020.3.21",status:2},book:{bookId:"2",name:"我的名字",author:"李贵林",isbn:"564564212",type:1,description:"这是一本不知道用来干嘛的书",status:0,image:"#",campus:"九龙湖校区",price:15,recommend:"1",sellerID:"12346"}}],orderList:[{id:1,orderId:1,account:"刘德华",orderTime:10.21,shipTime:11.21,getTime:12.21,coverImgList:[],orderDetailDtoList:[{book:{id:5,bookName:"我的名字",author:"李贵林",isbn:"123456798878",price:"52",description:"这是一本用来测试的书籍",put:!0,coverImg:""},num:1,price:52}],expense:{orderId:846546545132,productTotalMoney:52,freight:null,finallyPrice:null},address:{id:1,account:"黄小龙",name:"小胖",phone:"18988798892",addr:"江西抚州市临川区西大街街道东华理工大学长江学院本部(330006)",label:"家",off:!1}}],beUserDelete:!1}},created(){console.log("开始构建订单组件"),this.function_getList()},methods:{handleClick(e,o){switch(console.log("=====this.activeName===="+this.activeName+"======="),this.activeName){case"first":this.orderStatus="",this.beUserDelete=!1;break;case"third":this.orderStatus="已发货",this.beUserDelete=!1;break;case"four":this.orderStatus="",this.beUserDelete=!0;break}console.log("=====this.orderStatus====="+this.orderStatus+"======"),this.getOrderList(1,5)},handleChange(e){console.log(e.order.status),(0,z.Sg)(e.order.orderId).then((e=>{console.log(e),1===e.data.code?console.log("修改订单状态成功"):(console.log("状态码错误，失败"),this.$message({type:"waring",message:"获取订单失败"}))})).catch((e=>{console.log(e)})),console.log(e.order.status),console.log(e),console.log("收货成功")},goToOrderDetail(e){console.log("=====跳转到订单详情页========"),this.$router.push({path:"/user/userOrder/userOrderDetail",query:{orderId:e.order.orderId,bookId:e.book.bookId}})},async function_getList(){try{const e=await(0,z.tT)();if(console.log(e),1===e.data.code){const o=e.data.data,t=o.length;for(let e=0;e<t;e++){const t=await(0,D.Ms)(o[e].bookId);if(console.log(t),1===t.data.code){console.log("获取书籍成功");const s=o[e],r=t.data.data;this.orderAndBookList.push({order:s,book:r}),console.log(this.orderAndBookList[e].order),console.log(this.orderAndBookList[e].book)}else console.log("获取书籍失败"),this.$message({message:t.message,type:"warning"})}console.log("订单获取成功")}else this.$message({message:e.message,type:"warning"});console.log("订单所有信息更新成功")}catch(e){console.log(e)}},getOrder(e){this.$confirm("确认收货码?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{(0,z.Sg)(e).then((e=>{200==e.code?this.$message({message:e.message,type:"success"}):this.$message({message:e.message,type:"warning"})})).catch((e=>{this.$message({message:"确认收货出错了",type:"warning"})}))})).catch((()=>{this.$message({message:"取消确认收货",type:"warning"})}))}}},Z=t(89);const L=(0,Z.Z)(B,[["render",O],["__scopeId","data-v-8a65cccc"]]);var P=L}}]);
//# sourceMappingURL=14.6c20bf53.js.map